export interface Enchantment {
    id: string;
    name: string;
    maxLevel: number;
    itemTypes: string[];
    incompatibleWith: string[];
    anvilCost: number;
    bookCost: number;
}

export const itemTypes = [
    'sword',
    'axe',
    'pickaxe',
    'shovel',
    'hoe',
    'bow',
    'crossbow',
    'trident',
    'helmet',
    'chestplate',
    'leggings',
    'boots',
    'elytra',
    'fishing_rod',
    'shears',
    'flint_and_steel',
    'shield',
    'mace',
] as const;

export type ItemType = (typeof itemTypes)[number];

export const enchantments: Enchantment[] = [
    // Weapon enchantments
    {
        id: 'sharpness',
        name: 'Sharpness',
        maxLevel: 5,
        itemTypes: ['sword', 'axe'],
        incompatibleWith: ['smite', 'bane_of_arthropods'],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'smite',
        name: 'Smite',
        maxLevel: 5,
        itemTypes: ['sword', 'axe'],
        incompatibleWith: ['sharpness', 'bane_of_arthropods'],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'bane_of_arthropods',
        name: 'Bane of Arthropods',
        maxLevel: 5,
        itemTypes: ['sword', 'axe'],
        incompatibleWith: ['sharpness', 'smite'],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'looting',
        name: 'Looting',
        maxLevel: 3,
        itemTypes: ['sword'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'sweeping_edge',
        name: 'Sweeping Edge',
        maxLevel: 3,
        itemTypes: ['sword'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'knockback',
        name: 'Knockback',
        maxLevel: 2,
        itemTypes: ['sword'],
        incompatibleWith: [],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'fire_aspect',
        name: 'Fire Aspect',
        maxLevel: 2,
        itemTypes: ['sword'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    // Tool enchantments
    {
        id: 'efficiency',
        name: 'Efficiency',
        maxLevel: 5,
        itemTypes: ['pickaxe', 'shovel', 'axe', 'hoe', 'shears'],
        incompatibleWith: [],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'silk_touch',
        name: 'Silk Touch',
        maxLevel: 1,
        itemTypes: ['pickaxe', 'shovel', 'axe', 'hoe', 'shears'],
        incompatibleWith: ['fortune'],
        anvilCost: 4,
        bookCost: 4,
    },
    {
        id: 'fortune',
        name: 'Fortune',
        maxLevel: 3,
        itemTypes: ['pickaxe', 'shovel', 'axe', 'hoe'],
        incompatibleWith: ['silk_touch'],
        anvilCost: 2,
        bookCost: 2,
    },
    // Bow enchantments
    {
        id: 'power',
        name: 'Power',
        maxLevel: 5,
        itemTypes: ['bow'],
        incompatibleWith: [],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'punch',
        name: 'Punch',
        maxLevel: 2,
        itemTypes: ['bow'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'flame',
        name: 'Flame',
        maxLevel: 1,
        itemTypes: ['bow'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'infinity',
        name: 'Infinity',
        maxLevel: 1,
        itemTypes: ['bow'],
        incompatibleWith: ['mending'],
        anvilCost: 4,
        bookCost: 4,
    },
    // Crossbow enchantments
    {
        id: 'quick_charge',
        name: 'Quick Charge',
        maxLevel: 3,
        itemTypes: ['crossbow'],
        incompatibleWith: [],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'piercing',
        name: 'Piercing',
        maxLevel: 4,
        itemTypes: ['crossbow'],
        incompatibleWith: ['multishot'],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'multishot',
        name: 'Multishot',
        maxLevel: 1,
        itemTypes: ['crossbow'],
        incompatibleWith: ['piercing'],
        anvilCost: 2,
        bookCost: 2,
    },
    // Trident enchantments
    {
        id: 'loyalty',
        name: 'Loyalty',
        maxLevel: 3,
        itemTypes: ['trident'],
        incompatibleWith: ['riptide'],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'riptide',
        name: 'Riptide',
        maxLevel: 3,
        itemTypes: ['trident'],
        incompatibleWith: ['loyalty', 'channeling'],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'channeling',
        name: 'Channeling',
        maxLevel: 1,
        itemTypes: ['trident'],
        incompatibleWith: ['riptide'],
        anvilCost: 4,
        bookCost: 4,
    },
    {
        id: 'impaling',
        name: 'Impaling',
        maxLevel: 5,
        itemTypes: ['trident'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    // Armor enchantments
    {
        id: 'protection',
        name: 'Protection',
        maxLevel: 4,
        itemTypes: ['helmet', 'chestplate', 'leggings', 'boots'],
        incompatibleWith: [
            'fire_protection',
            'blast_protection',
            'projectile_protection',
        ],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'fire_protection',
        name: 'Fire Protection',
        maxLevel: 4,
        itemTypes: ['helmet', 'chestplate', 'leggings', 'boots'],
        incompatibleWith: [
            'protection',
            'blast_protection',
            'projectile_protection',
        ],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'blast_protection',
        name: 'Blast Protection',
        maxLevel: 4,
        itemTypes: ['helmet', 'chestplate', 'leggings', 'boots'],
        incompatibleWith: [
            'protection',
            'fire_protection',
            'projectile_protection',
        ],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'projectile_protection',
        name: 'Projectile Protection',
        maxLevel: 4,
        itemTypes: ['helmet', 'chestplate', 'leggings', 'boots'],
        incompatibleWith: [
            'protection',
            'fire_protection',
            'blast_protection',
        ],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'feather_falling',
        name: 'Feather Falling',
        maxLevel: 4,
        itemTypes: ['boots'],
        incompatibleWith: [],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'thorns',
        name: 'Thorns',
        maxLevel: 3,
        itemTypes: ['helmet', 'chestplate', 'leggings', 'boots'],
        incompatibleWith: [],
        anvilCost: 4,
        bookCost: 4,
    },
    {
        id: 'respiration',
        name: 'Respiration',
        maxLevel: 3,
        itemTypes: ['helmet'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'aqua_affinity',
        name: 'Aqua Affinity',
        maxLevel: 1,
        itemTypes: ['helmet'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'depth_strider',
        name: 'Depth Strider',
        maxLevel: 3,
        itemTypes: ['boots'],
        incompatibleWith: ['frost_walker'],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'frost_walker',
        name: 'Frost Walker',
        maxLevel: 2,
        itemTypes: ['boots'],
        incompatibleWith: ['depth_strider'],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'soul_speed',
        name: 'Soul Speed',
        maxLevel: 3,
        itemTypes: ['boots'],
        incompatibleWith: [],
        anvilCost: 4,
        bookCost: 4,
    },
    {
        id: 'swift_sneak',
        name: 'Swift Sneak',
        maxLevel: 3,
        itemTypes: ['leggings'],
        incompatibleWith: [],
        anvilCost: 4,
        bookCost: 4,
    },
    // Universal enchantments
    {
        id: 'unbreaking',
        name: 'Unbreaking',
        maxLevel: 3,
        itemTypes: [
            'sword',
            'axe',
            'pickaxe',
            'shovel',
            'hoe',
            'bow',
            'crossbow',
            'trident',
            'helmet',
            'chestplate',
            'leggings',
            'boots',
            'elytra',
            'fishing_rod',
            'shears',
            'flint_and_steel',
            'shield',
            'mace',
        ],
        incompatibleWith: [],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'mending',
        name: 'Mending',
        maxLevel: 1,
        itemTypes: [
            'sword',
            'axe',
            'pickaxe',
            'shovel',
            'hoe',
            'bow',
            'crossbow',
            'trident',
            'helmet',
            'chestplate',
            'leggings',
            'boots',
            'elytra',
            'fishing_rod',
            'shears',
            'flint_and_steel',
            'shield',
            'mace',
        ],
        incompatibleWith: ['infinity'],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'curse_of_vanishing',
        name: 'Curse of Vanishing',
        maxLevel: 1,
        itemTypes: [
            'sword',
            'axe',
            'pickaxe',
            'shovel',
            'hoe',
            'bow',
            'crossbow',
            'trident',
            'helmet',
            'chestplate',
            'leggings',
            'boots',
            'elytra',
            'fishing_rod',
            'shears',
            'flint_and_steel',
            'shield',
            'mace',
        ],
        incompatibleWith: [],
        anvilCost: 1,
        bookCost: 1,
    },
    // Fishing rod enchantments
    {
        id: 'luck_of_the_sea',
        name: 'Luck of the Sea',
        maxLevel: 3,
        itemTypes: ['fishing_rod'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'lure',
        name: 'Lure',
        maxLevel: 3,
        itemTypes: ['fishing_rod'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
    // Helmet-specific
    {
        id: 'curse_of_binding',
        name: 'Curse of Binding',
        maxLevel: 1,
        itemTypes: [
            'helmet',
            'chestplate',
            'leggings',
            'boots',
            'elytra',
            'shield',
        ],
        incompatibleWith: [],
        anvilCost: 1,
        bookCost: 1,
    },
    // Mace enchantments
    {
        id: 'density',
        name: 'Density',
        maxLevel: 5,
        itemTypes: ['mace'],
        incompatibleWith: ['breach', 'smite', 'bane_of_arthropods'],
        anvilCost: 1,
        bookCost: 1,
    },
    {
        id: 'breach',
        name: 'Breach',
        maxLevel: 4,
        itemTypes: ['mace'],
        incompatibleWith: ['density'],
        anvilCost: 2,
        bookCost: 2,
    },
    {
        id: 'wind_burst',
        name: 'Wind Burst',
        maxLevel: 3,
        itemTypes: ['mace'],
        incompatibleWith: [],
        anvilCost: 2,
        bookCost: 2,
    },
];

export function getEnchantmentsForItem(itemType: ItemType): Enchantment[] {
    return enchantments.filter((e) => e.itemTypes.includes(itemType));
}

export function areEnchantmentsCompatible(
    enchantmentId1: string,
    enchantmentId2: string,
): boolean {
    const enc1 = enchantments.find((e) => e.id === enchantmentId1);
    const enc2 = enchantments.find((e) => e.id === enchantmentId2);

    if (!enc1 || !enc2) {
        return false;
    }

    return (
        !enc1.incompatibleWith.includes(enchantmentId2) &&
        !enc2.incompatibleWith.includes(enchantmentId1)
    );
}
